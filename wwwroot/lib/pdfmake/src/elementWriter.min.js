/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/pdfmake@0.1.68/src/elementWriter.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var Line=require("./line"),isNumber=require("./helpers").isNumber,pack=require("./helpers").pack,offsetVector=require("./helpers").offsetVector,DocumentContext=require("./documentContext");function ElementWriter(t,e){this.context=t,this.contextStack=[],this.tracker=e}function addPageItem(t,e,i){null==i||i<0||i>t.items.length?t.items.push(e):t.items.splice(i,0,e)}function cloneLine(t){var e=new Line(t.maxWidth);for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}ElementWriter.prototype.addLine=function(t,e,i){var n=t.getHeight(),r=this.context,o=r.getCurrentPage(),a=this.getCurrentPositionOnPage();return!(r.availableHeight<n||!o)&&(t.x=r.x+(t.x||0),t.y=r.y+(t.y||0),this.alignLine(t),addPageItem(o,{type:"line",item:t},i),this.tracker.emit("lineAdded",t),e||r.moveDown(n),a)},ElementWriter.prototype.alignLine=function(t){var e=this.context.availableWidth,i=t.getWidth(),n=t.inlines&&t.inlines.length>0&&t.inlines[0].alignment,r=0;switch(n){case"right":r=e-i;break;case"center":r=(e-i)/2}if(r&&(t.x=(t.x||0)+r),"justify"===n&&!t.newLineForced&&!t.lastLineInParagraph&&t.inlines.length>1)for(var o=(e-i)/(t.inlines.length-1),a=1,s=t.inlines.length;a<s;a++)r=a*o,t.inlines[a].x+=r,t.inlines[a].justifyShift=o},ElementWriter.prototype.addImage=function(t,e,i){var n=this.context,r=n.getCurrentPage(),o=this.getCurrentPositionOnPage();return!(!r||void 0===t.absolutePosition&&n.availableHeight<t._height&&r.items.length>0)&&(void 0===t._x&&(t._x=t.x||0),t.x=n.x+t._x,t.y=n.y,this.alignImage(t),addPageItem(r,{type:i||"image",item:t},e),n.moveDown(t._height),o)},ElementWriter.prototype.addSVG=function(t,e){return this.addImage(t,e,"svg")},ElementWriter.prototype.addQr=function(t,e){var i=this.context,n=i.getCurrentPage(),r=this.getCurrentPositionOnPage();if(!n||void 0===t.absolutePosition&&i.availableHeight<t._height)return!1;void 0===t._x&&(t._x=t.x||0),t.x=i.x+t._x,t.y=i.y,this.alignImage(t);for(var o=0,a=t._canvas.length;o<a;o++){var s=t._canvas[o];s.x+=t.x,s.y+=t.y,this.addVector(s,!0,!0,e)}return i.moveDown(t._height),r},ElementWriter.prototype.alignImage=function(t){var e=this.context.availableWidth,i=t._minWidth,n=0;switch(t._alignment){case"right":n=e-i;break;case"center":n=(e-i)/2}n&&(t.x=(t.x||0)+n)},ElementWriter.prototype.alignCanvas=function(t){var e=this.context.availableWidth,i=t._minWidth,n=0;switch(t._alignment){case"right":n=e-i;break;case"center":n=(e-i)/2}n&&t.canvas.forEach(function(t){offsetVector(t,n,0)})},ElementWriter.prototype.addVector=function(t,e,i,n){var r=this.context,o=r.getCurrentPage(),a=this.getCurrentPositionOnPage();if(o)return offsetVector(t,e?0:r.x,i?0:r.y),addPageItem(o,{type:"vector",item:t},n),a},ElementWriter.prototype.beginClip=function(t,e){var i=this.context;return i.getCurrentPage().items.push({type:"beginClip",item:{x:i.x,y:i.y,width:t,height:e}}),!0},ElementWriter.prototype.endClip=function(){return this.context.getCurrentPage().items.push({type:"endClip"}),!0},ElementWriter.prototype.addFragment=function(t,e,i,n){var r=this.context,o=r.getCurrentPage();return!(!e&&t.height>r.availableHeight)&&(t.items.forEach(function(n){switch(n.type){case"line":var a=cloneLine(n.item);a._node&&(a._node.positions[0].pageNumber=r.page+1),a.x=(a.x||0)+(e?t.xOffset||0:r.x),a.y=(a.y||0)+(i?t.yOffset||0:r.y),o.items.push({type:"line",item:a});break;case"vector":var s=pack(n.item);offsetVector(s,e?t.xOffset||0:r.x,i?t.yOffset||0:r.y),o.items.push({type:"vector",item:s});break;case"image":case"svg":var h=pack(n.item);h.x=(h.x||0)+(e?t.xOffset||0:r.x),h.y=(h.y||0)+(i?t.yOffset||0:r.y),o.items.push({type:n.type,item:h})}}),n||r.moveDown(t.height),!0)},ElementWriter.prototype.pushContext=function(t,e){void 0===t&&(e=this.context.getCurrentPage().height-this.context.pageMargins.top-this.context.pageMargins.bottom,t=this.context.availableWidth),isNumber(t)&&(t=new DocumentContext({width:t,height:e},{left:0,right:0,top:0,bottom:0})),this.contextStack.push(this.context),this.context=t},ElementWriter.prototype.popContext=function(){this.context=this.contextStack.pop()},ElementWriter.prototype.getCurrentPositionOnPage=function(){return(this.contextStack[0]||this.context).getCurrentPosition()},module.exports=ElementWriter;
//# sourceMappingURL=/sm/80918f028bd4319f8fe6829f432bc5660fae8a591e69ef1e1aa6259882756b3b.map