/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/pdfmake@0.1.68/src/documentContext.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var TraversalTracker=require("./traversalTracker"),isString=require("./helpers").isString;function DocumentContext(t,i){this.pages=[],this.pageMargins=i,this.x=i.left,this.availableWidth=t.width-i.left-i.right,this.availableHeight=0,this.page=-1,this.snapshots=[],this.endingCell=null,this.tracker=new TraversalTracker,this.backgroundLength=[],this.addPage(t)}function pageOrientation(t,i){return void 0===t?i:isString(t)&&"landscape"===t.toLowerCase()?"landscape":"portrait"}DocumentContext.prototype.beginColumnGroup=function(){this.snapshots.push({x:this.x,y:this.y,availableHeight:this.availableHeight,availableWidth:this.availableWidth,page:this.page,bottomMost:{x:this.x,y:this.y,availableHeight:this.availableHeight,availableWidth:this.availableWidth,page:this.page},endingCell:this.endingCell,lastColumnWidth:this.lastColumnWidth}),this.lastColumnWidth=0},DocumentContext.prototype.beginColumn=function(t,i,e){var a=this.snapshots[this.snapshots.length-1];this.calculateBottomMost(a),this.endingCell=e,this.page=a.page,this.x=this.x+this.lastColumnWidth+(i||0),this.y=a.y,this.availableWidth=t,this.availableHeight=a.availableHeight,this.lastColumnWidth=t},DocumentContext.prototype.calculateBottomMost=function(t){this.endingCell?(this.saveContextInEndingCell(this.endingCell),this.endingCell=null):t.bottomMost=bottomMostContext(this,t.bottomMost)},DocumentContext.prototype.markEnding=function(t){this.page=t._columnEndingContext.page,this.x=t._columnEndingContext.x,this.y=t._columnEndingContext.y,this.availableWidth=t._columnEndingContext.availableWidth,this.availableHeight=t._columnEndingContext.availableHeight,this.lastColumnWidth=t._columnEndingContext.lastColumnWidth},DocumentContext.prototype.saveContextInEndingCell=function(t){t._columnEndingContext={page:this.page,x:this.x,y:this.y,availableHeight:this.availableHeight,availableWidth:this.availableWidth,lastColumnWidth:this.lastColumnWidth}},DocumentContext.prototype.completeColumnGroup=function(t){var i=this.snapshots.pop();this.calculateBottomMost(i),this.endingCell=null,this.x=i.x;var e=i.bottomMost.y;t&&(i.page===i.bottomMost.page?i.y+t>e&&(e=i.y+t):e+=t),this.y=e,this.page=i.bottomMost.page,this.availableWidth=i.availableWidth,this.availableHeight=i.bottomMost.availableHeight,t&&(this.availableHeight-=e-i.bottomMost.y),this.lastColumnWidth=i.lastColumnWidth},DocumentContext.prototype.addMargin=function(t,i){this.x+=t,this.availableWidth-=t+(i||0)},DocumentContext.prototype.moveDown=function(t){return this.y+=t,this.availableHeight-=t,this.availableHeight>0},DocumentContext.prototype.initializePage=function(){this.y=this.pageMargins.top,this.availableHeight=this.getCurrentPage().pageSize.height-this.pageMargins.top-this.pageMargins.bottom,this.pageSnapshot().availableWidth=this.getCurrentPage().pageSize.width-this.pageMargins.left-this.pageMargins.right},DocumentContext.prototype.pageSnapshot=function(){return this.snapshots[0]?this.snapshots[0]:this},DocumentContext.prototype.moveTo=function(t,i){null!=t&&(this.x=t,this.availableWidth=this.getCurrentPage().pageSize.width-this.x-this.pageMargins.right),null!=i&&(this.y=i,this.availableHeight=this.getCurrentPage().pageSize.height-this.y-this.pageMargins.bottom)},DocumentContext.prototype.moveToRelative=function(t,i){null!=t&&(this.x=this.x+t),null!=i&&(this.y=this.y+i)},DocumentContext.prototype.beginDetachedBlock=function(){this.snapshots.push({x:this.x,y:this.y,availableHeight:this.availableHeight,availableWidth:this.availableWidth,page:this.page,endingCell:this.endingCell,lastColumnWidth:this.lastColumnWidth})},DocumentContext.prototype.endDetachedBlock=function(){var t=this.snapshots.pop();this.x=t.x,this.y=t.y,this.availableWidth=t.availableWidth,this.availableHeight=t.availableHeight,this.page=t.page,this.endingCell=t.endingCell,this.lastColumnWidth=t.lastColumnWidth};var getPageSize=function(t,i){return(i=pageOrientation(i,t.pageSize.orientation))!==t.pageSize.orientation?{orientation:i,width:t.pageSize.height,height:t.pageSize.width}:{orientation:t.pageSize.orientation,width:t.pageSize.width,height:t.pageSize.height}};function bottomMostContext(t,i){var e;return{page:(e=t.page>i.page?t:i.page>t.page?i:t.y>i.y?t:i).page,x:e.x,y:e.y,availableHeight:e.availableHeight,availableWidth:e.availableWidth}}DocumentContext.prototype.moveToNextPage=function(t){var i=this.page+1,e=this.page,a=this.y,n=i>=this.pages.length;if(n){var h=this.availableWidth,s=this.getCurrentPage().pageSize.orientation,o=getPageSize(this.getCurrentPage(),t);this.addPage(o),s===o.orientation&&(this.availableWidth=h)}else this.page=i,this.initializePage();return{newPageCreated:n,prevPage:e,prevY:a,y:this.y}},DocumentContext.prototype.addPage=function(t){var i={items:[],pageSize:t};return this.pages.push(i),this.backgroundLength.push(0),this.page=this.pages.length-1,this.initializePage(),this.tracker.emit("pageAdded"),i},DocumentContext.prototype.getCurrentPage=function(){return this.page<0||this.page>=this.pages.length?null:this.pages[this.page]},DocumentContext.prototype.getCurrentPosition=function(){var t=this.getCurrentPage().pageSize,i=t.height-this.pageMargins.top-this.pageMargins.bottom,e=t.width-this.pageMargins.left-this.pageMargins.right;return{pageNumber:this.page+1,pageOrientation:t.orientation,pageInnerHeight:i,pageInnerWidth:e,left:this.x,top:this.y,verticalRatio:(this.y-this.pageMargins.top)/i,horizontalRatio:(this.x-this.pageMargins.left)/e}},module.exports=DocumentContext;
//# sourceMappingURL=/sm/dfc3aeb44b06865ae88565dda182c06830d97295cdd3407d30a9920a65254b0e.map