/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/pdfmake@0.1.68/src/textTools.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var isString=require("./helpers").isString,isNumber=require("./helpers").isNumber,isObject=require("./helpers").isObject,isArray=require("./helpers").isArray,isUndefined=require("./helpers").isUndefined,LineBreaker=require("linebreak"),LEADING=/^(\s)+/g,TRAILING=/(\s)+$/g;function TextTools(t){this.fontProvider=t}function splitWords(t,e){var r=[];if(t=t.replace(/\t/g,"    "),e)return r.push({text:t}),r;for(var n,i=new LineBreaker(t),o=0;n=i.nextBreak();){var l=t.slice(o,n.position);n.required||l.match(/\r?\n$|\r$/)?(l=l.replace(/\r?\n$|\r$/,""),r.push({text:l,lineEnd:!0})):r.push({text:l}),o=n.position}return r}function copyStyle(t,e){for(var r in e=e||{},t=t||{})"text"!=r&&t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function normalizeTextArray(t,e){function r(t,e,r){if(isUndefined(e[t]))return null;if(e[t].lineEnd)return null;var n=e[t].text;if(r){var i=splitWords(normalizeString(n),!1);if(isUndefined(i[i.length-1]))return null;n=i[i.length-1].text}return n}var n=[];isArray(t)||(t=[t]);for(var i=null,o=0,l=(t=function t(e){return e.reduce(function(e,r){var n=isArray(r.text)?t(r.text):r,i=[].concat(n).some(Array.isArray);return e.concat(i?t(n):n)},[])}(t)).length;o<l;o++){var a,g=t[o],u=null,s=getStyleProperty(g||{},e,"noWrap",!1);if(isObject(g)?(g._textRef&&g._textRef._textNodeRef.text&&(g.text=g._textRef._textNodeRef.text),a=splitWords(normalizeString(g.text),s),u=copyStyle(g)):a=splitWords(normalizeString(g),s),i&&a.length)1===splitWords(normalizeString(i+r(0,a,s)),!1).length&&(n[n.length-1].noNewLine=!0);for(var y=0,d=a.length;y<d;y++){var h={text:a[y].text};a[y].lineEnd&&(h.lineEnd=!0),copyStyle(u,h),n.push(h)}i=null,o+1<l&&(i=r(a.length-1,a,s))}return n}function normalizeString(t){return null==t?"":isNumber(t)?t.toString():isString(t)?t:t.toString()}function getStyleProperty(t,e,r,n){var i;return void 0!==t[r]&&null!==t[r]?t[r]:e?(e.auto(t,function(){i=e.getProperty(r)}),null!=i?i:n):n}function measure(t,e,r){var n=normalizeTextArray(e,r);if(n.length){var i=getStyleProperty(n[0],r,"leadingIndent",0);i&&(n[0].leadingCut=-i,n[0].leadingIndent=i)}return n.forEach(function(e){var n,i,o=getStyleProperty(e,r,"font","Roboto"),l=getStyleProperty(e,r,"fontSize",12),a=getStyleProperty(e,r,"fontFeatures",null),g=getStyleProperty(e,r,"bold",!1),u=getStyleProperty(e,r,"italics",!1),s=getStyleProperty(e,r,"color","black"),y=getStyleProperty(e,r,"decoration",null),d=getStyleProperty(e,r,"decorationColor",null),h=getStyleProperty(e,r,"decorationStyle",null),p=getStyleProperty(e,r,"background",null),c=getStyleProperty(e,r,"lineHeight",1),S=getStyleProperty(e,r,"characterSpacing",0),f=getStyleProperty(e,r,"link",null),P=getStyleProperty(e,r,"linkToPage",null),x=getStyleProperty(e,r,"linkToDestination",null),v=getStyleProperty(e,r,"noWrap",null),m=getStyleProperty(e,r,"preserveLeadingSpaces",!1),T=getStyleProperty(e,r,"preserveTrailingSpaces",!1),w=getStyleProperty(e,r,"opacity",1),b=t.provideFont(o,g,u);e.width=widthOfString(e.text,b,l,S,a),e.height=b.lineHeight(l)*c,e.leadingCut||(e.leadingCut=0),!m&&(n=e.text.match(LEADING))&&(e.leadingCut+=widthOfString(n[0],b,l,S,a)),!T&&(i=e.text.match(TRAILING))?e.trailingCut=widthOfString(i[0],b,l,S,a):e.trailingCut=0,e.alignment=getStyleProperty(e,r,"alignment","left"),e.font=b,e.fontSize=l,e.fontFeatures=a,e.characterSpacing=S,e.color=s,e.decoration=y,e.decorationColor=d,e.decorationStyle=h,e.background=p,e.link=f,e.linkToPage=P,e.linkToDestination=x,e.noWrap=v,e.opacity=w}),n}function widthOfString(t,e,r,n,i){return e.widthOfString(t,r,i)+(n||0)*(t.length-1)}TextTools.prototype.buildInlines=function(t,e){var r,n=measure(this.fontProvider,t,e),i=0,o=0;return n.forEach(function(t){var e;i=Math.max(i,t.width-t.leadingCut-t.trailingCut),r||(r={width:0,leadingCut:t.leadingCut,trailingCut:0}),r.width+=t.width,r.trailingCut=t.trailingCut,o=Math.max(o,(e=r,Math.max(0,e.width-e.leadingCut-e.trailingCut))),t.lineEnd&&(r=null)}),getStyleProperty({},e,"noWrap",!1)&&(i=o),{items:n,minWidth:i,maxWidth:o}},TextTools.prototype.sizeOfString=function(t,e){t=t?t.toString().replace(/\t/g,"    "):"";var r=getStyleProperty({},e,"font","Roboto"),n=getStyleProperty({},e,"fontSize",12),i=getStyleProperty({},e,"fontFeatures",null),o=getStyleProperty({},e,"bold",!1),l=getStyleProperty({},e,"italics",!1),a=getStyleProperty({},e,"lineHeight",1),g=getStyleProperty({},e,"characterSpacing",0),u=this.fontProvider.provideFont(r,o,l);return{width:widthOfString(t,u,n,g,i),height:u.lineHeight(n)*a,fontSize:n,lineHeight:a,ascender:u.ascender/1e3*n,descender:u.descender/1e3*n}},TextTools.prototype.sizeOfRotatedText=function(t,e,r){var n=e*Math.PI/-180,i=this.sizeOfString(t,r);return{width:Math.abs(i.height*Math.sin(n))+Math.abs(i.width*Math.cos(n)),height:Math.abs(i.width*Math.sin(n))+Math.abs(i.height*Math.cos(n))}},TextTools.prototype.widthOfString=function(t,e,r,n,i){return widthOfString(t,e,r,n,i)},module.exports=TextTools;
//# sourceMappingURL=/sm/2f6527230e78b4c67fcbf88feb0e13af32508ac9212da22e742a1c31fdfbd1d6.map